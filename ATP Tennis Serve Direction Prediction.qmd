---
title: "ATP Tennis Serve Direction Prediction"
format: html
---

# Import Dependencies

Libraries that will come in handy in the future.
```{r}
library(tidyverse)
library(caret)
library(randomForest)
library(e1071)
library(rpart)
library(nnet)
```

# Import Data and add Surface Information to Points

Import the specific data that I will be working with.  
In this case, I want data about serving and point basics on a specific surface (hard, clay or grass).
```{r}
matches_men <- read_csv("C:\\Users\\Rino Cattabiani\\Mens Data\\charting-m-matches.csv")
matches_women <- read_csv("C:\\Users\\Rino Cattabiani\\Womens Data\\charting-w-matches.csv")
points_men <- read_csv("C:\\Users\\Rino Cattabiani\\Mens Data\\charting-m-points-2020s.csv")
points_women <- read_csv("C:\\Users\\Rino Cattabiani\\Womens Data\\charting-w-points-2020s.csv")

surface_lookup_men <- matches_men %>%
    select(match_id, Surface) %>%
    rename(surface = Surface)
surface_lookup_women <- matches_women %>%
    select(match_id, Surface) %>%
    rename(surface = Surface)

points_men <- points_men %>% left_join(surface_lookup_men, by = "match_id")
points_women <- points_women %>% left_join(surface_lookup_women, by = "match_id")

cat(sprintf("Loaded %d men's points and %d women's points\n", nrow(points_men), nrow(points_women)))
```

# Add serve direction parser 

I want to know when the serve is hit in the direction of 'T' (Down the center service line), 'B' (Body), or 'W' (Wide).
```{r}
parse_serve_direction <- function(serve_code) {
    if (is.na(serve_code) || serve_code == "") {
        return(NA)
    }
    first_char <- substr(serve_code, 1, 1)
    case_when(
        first_char == "4" ~ "W",
        first_char == "5" ~ "B",
        first_char == "6" ~ "T",
        TRUE ~ NA_character_
    )
}
```